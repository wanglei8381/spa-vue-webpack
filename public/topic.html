<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <title>话题分享</title>
    <link rel="stylesheet" href="css/ui-base.css">
    <link rel="stylesheet" href="css/common.css">
    <script src="js/resetFontSize.js?375"></script>

</head>
<body ontouchstart>

<!--topic start-->
<div class="topic">
    <div class="ub">
        <div class="topicMarks ub-img"></div>
        <div class="joinPerson"><span class="joinTopicNum"></span>人&nbsp;参与</div>
    </div>
    <div class="topicTitle">写下你最近单曲循环的歌曲+此刻的心情</div>
    <div class="ub ub-ac">
        <div>
            <img src="" alt="" class="commentUserIcon topicUserIcon">
        </div>
        <div class="topicAdmin"></div>
        <div class="ub-f1"><span class="topicType">楼主</span></div>
    </div>
    <hr class="topicHr">
    <div class="topicContent">
    </div>
    <div class="more ub ub-ver ub-ac uhide">
        <div>查看全部</div>
        <div class="ub-img moredown"></div>
    </div>
</div>
<!--topic end-->

<div class="commonSpace"></div>

<!--commend strat-->
<div class="comment">
    <div class="ub ub-ver commentTitle">
        <div class="titleB">热门评论</div>
        <div class="titleS">HOT COMMENTS</div>
    </div>
    <div class="commentList"></div>
    <div class="appDown ub ub-ver ub-ac">
        <div class="ub-img appImage"></div>
        <div class="ub appText">
            <div>打开片刻APP</div>
            <div class="appComma">,</div>
            <div>查看全部<span>78</span>条评论</div>
        </div>
    </div>
</div>
<!--commend end-->

<div class="commonSpace ub">
</div>

<!--hot-share start-->
<div class="hot">
    <div class="ub ub-ver hotTitle ub-ac">
        <div class="titleB">热门文章</div>
        <div class="titleS">HOT ARTICLES</div>
        <div class="hotLine"></div>
    </div>
    <div class="ub ub-ver articleList">
    </div>
</div>
<div class="commonSpace ub">
</div>
<div class="hotTimgB">
    <div class="ub ub-ver hotTitle ub-ac">
        <div class="titleB">热门TING</div>
        <div class="titleS">HOT TING</div>
        <div class="hotLine"></div>
    </div>
    <div class="ub tingList">
    </div>
</div>
<div class="commonSpace ub">
</div>
<div class="hot">
    <div class="ub ub-ver hotTitle ub-ac">
        <div class="titleB">热门话题</div>
        <div class="titleS">HOT TOPICS</div>
        <div class="hotLine"></div>
    </div>
    <div class="topicList"></div>
</div>
<div class="commonSpace ub">
</div>
<div class="hot hotBottom">
    <div class="ub ub-ver hotTitle ub-ac">
        <div class="titleB">热门音乐</div>
        <div class="titleS">HOT MUSIC</div>
        <div class="hotLine"></div>
    </div>
    <div class="musicList"></div>
</div>
<!--hot-share end-->

<!--footer start-->
<div class="footer">
    <div class="ub ub-ac ub-pc">
        <div class="ub ub-img logo"></div>
        <div class="ub-f1 ub ub-ver">
            片刻
            <div class="footerFontS">世界很美,&nbsp;而你正好有空</div>
        </div>
        <div class="ub footerDown">下载&nbsp;APP</div>
    </div>
</div>

<!--footer end-->
<script src="js/zepto.js"></script>
<script src="js/md5.js"></script>
<script src="js/jquery.base64.js"></script>
<script src="js/common.js"></script>
<script>
    //请求接口,获取话题详情信息
    /*var id = '5740021702334d673ee8e71e';
     R.ajax({
     url: 'topic/info.php',
     data: {
     contentid: id
     },
     success: function (data) {
     showTopicInfo(data)
     }
     });*/
    showTopicInfo();
    function showTopicInfo() {
        $('.topicUserIcon').attr('src', topicData.userinfo.icon);//楼主头像
        $('.joinTopicNum').html(topicData.topicUsers);//参与人数
        $('.topicAdmin').html(topicData.userinfo.uname);//楼主
        $('.topicTitle').html(topicData.title);//话题标题
        var topicContent = topicData.html;
        $('.topicContent').html(topicCols(topicContent).shortHtml);//话题内容
        if(topicCols(topicContent).dataLenght>5){
            $('.more').removeClass('uhide');
        }
        $('.more').click(function(){
            $('.topicContent').html(topicData.html);//话题内容
            $('.more').addClass('uhide');
        })
    }


    //请求接口,获取话题评论列表
    /*var id = '5740021702334d673ee8e71e';
     R.ajax({
     url: 'comment/list.php',
     data: {
     contentid: id,
     pageSize: 3,
     isAll: 0
     },
     success: function (data) {
     showTopicCommentList(data)
     }
     });*/
    showTopicCommentList();
    function showTopicCommentList() {
        var str = '';
        for (var i = 0; i < 3; i++) {
            str += '<div class="ub ub-ver commentBody">' +
                    '<div class="ub ub-ac">' +
                    '<div class="ub">' +
                    '<img src="' + commentList[i].userinfo.icon + '" class="commentUserIcon" alt="">' +
                    '</div>' +
                    '<div class="ub-f1 commentUserName">' + commentList[i].userinfo.uname + '</div>' +
                    '<div class="ub ub-pe">' +
                    '<div class="ub-img praiseImg"></div>' +
                    '<div class="praise">' + commentList[i].goods + '</div>' +
                    '</div>' +
                    '</div>' +
                    '<div class="commentContent">' + commentList[i].content + '</div>' +
                    '</div>';
        }
        $('.commentList').html(str);
    }


    //请求接口,获取热门数据
    /*R.ajax({
        url: 'pub/today.php',
        data: {
            pageSize: 30
        },
        success: function (data) {
            showHotTopic(data)
        }
    });*/


    //热门数据分类
    var articleArr = [];
    var tingArr = [];
    var topicArr = [];
    var musicArr = [];
    $.each(hotList, function (idx, item) {
        if (item.content.type == '15') { //article
            var articleItem = {
                'id': item.content.id,
                'title': item.content.title
            }
            articleArr.push(articleItem);

        } else if (item.content.type == '17') { //ting
            var tingItem = {
                'id': item.tingInfo.contentid,
                'title': item.tingInfo.title,
                'coverimg': item.tingInfo.imgUrl
            }
            tingArr.push(tingItem);
        } else if (item.content.type == '24') { //topic
            var topicItem = {
                'id': item.content.id,
                'title': item.content.title,
                'coverimg': item.content.coverimg
            }
            topicArr.push(topicItem);
        } else if (item.content.type == '25') { //music
            var musicItem = {
                'id': item.content.id,
                'title': item.content.title
                //'coverimg': item.content.coverimg
            }
            musicArr.push(musicItem);
        }
    })

    //展示热门文章
    showHotArticle();
    function showHotArticle() {
        var str = '';
        for (var i = 0; i < 3; i++) {
            str += '<div class="ub-f1 hotContent hotArticle" id="'+ articleArr[i].id +'">' + articleArr[i].title + '</div>';
        }
        $('.articleList').html(str);
        $('.hotArticle').click(function(){
            console.log(this.id)
            window.open('article.html');
        })
    }

    //展示热门Ting
    showHotTing();
    function showHotTing() {
        var str = '';
        for (var i = 0; i < 3; i++) {
            var title = tingArr[i].title;
            if (title.length > 6) {
                title = title.substring(0, 6) + '...'
            }
            str += '<div class="ub-f1 ub-ver hotTing hotMarginLR" id="'+ tingArr[i].id +'">' +
                    '<img src="' + tingArr[i].coverimg + '" alt="" width="100%">' +
                    '<div class="hotContentTing">' + title + '</div>' +
                    '</div>';
        }
        $('.tingList').html(str);
        $('.hotTing').click(function(){
            console.log(this.id)
            window.open('radio.html');
        })

    }

    //  展示热门话题
    showHotTopic();
    function showHotTopic() {
        var str = '';
        for (var i = 0; i < 3; i++) {
            str += '<div class="ub ub-ac hotCotentTopic hotMarginTB hotTopicItem" id="'+ topicArr[i].id +'">' +
                    '<div class="ub">' +
                    '<img src="' + topicArr[i].coverimg + '" class="hotTopic" alt="">' +
                    '</div>' +
                    '<div class="hotPaddL ub-f1">' + topicArr[i].title + '</div>' +
                    '</div>';
        }
        $('.topicList').html(str);
        $('.hotTopicItem').click(function(){
            console.log(this.id)
            window.open('topic.html');
        })
    }

    //展示热门音乐
    showHotMusic();
    function showHotMusic() {
        var str = '';
        for (var i = 0; i < 3; i++) {
            str += '<div class="ub ub-ac hotCotentTopic hotMusicItem hotMarginMusicTB" id="'+ musicArr[i].id +'">' +
                    '<div class="ub">' +
                    '<img src="img/hotMusic.png" class="hotMusic" alt="">' +
                    '</div>' +
                    '<div class="hotPaddL ub-f1">' + musicArr[i].title + '</div>' +
                    '<div class="ub ub-img hotMusicPlay"></div>' +
                    '</div>';
        }
        $('.musicList').html(str);
        $('.hotMusicItem').click(function(){
            console.log(this.id)
            window.open('music.html');
        })
    }

</script>
</body>
</html>